{% extends 'base.html' %}

{% load bootstrap3 %}
{% load i18n %}
{% load humanize %}
{% load memopol_tags %}
{% load staticfiles %}

{% with representative=object %}

  {% block title %}{{ representative.full_name }}{% endblock %}

  {% block content %}
  <div class="row" id="representative-detail">
    <div class="col-sm-3" id="representative-photo" style="background-image:url({{ representative.photo }});">
    </div>

    <div class="col-sm-9" id="representative-info">
      <h1 class="text-center">{{ representative.full_name }}</h1>

      <div class="col-sm-9">
        <dl class="dl-horizontal">
          <dt>{% trans "Score" %}</dt>
          <dd>
            <span class="badge" data-toggle="tooltip" data-placement="right" title="{% trans "Total score is the sum of score contributions for each of this representatives votes" %}">{{ representative.score.score }}</span>
          </dd>

          <dt>{% trans "Country" %}</dt>
          <dd>
            {{ representative.country|country_flag }} {{ representative.country.name }}
          </dd>

          {% with mandate=representative.main_mandate %}

            <dt>{% trans "Chamber" %}</dt>
            <dd>
              {{ mandate.group.chamber|chamber_icon }} {{ mandate.group.chamber.name }}
            </dd>

            <dt>{% trans "Party" %}</dt>
            <dd>
              {{ mandate.group|group_icon }} {{ mandate.group.name }}
              {% if mandate.group.abbreviation %}({{ mandate.group.abbreviation }}){% endif %}
            </dd>

          {% endwith %}

          <dt>{% trans "Biography" %}</dt>
          <dd>{% blocktrans with birth_place=representative.birth_place birth_date=representative.birth_date|naturalday:'d/m/Y' %}Born on {{ birth_date }} in {{ birth_place }}{% endblocktrans %}
          </dd>

          {% if representative.social_websites|length or representative.chamber_websites|length or representative.other_websites|length %}
            <dt>{% trans "Links" %}</dt>
            <dd>
              {% for site in representative.social_websites %}
                <a class="label label-primary" href="{{ site.url }}" target="_blank">
                  <img class="social-icon" src="{% static 'images' %}/social-{{ site.kind }}.png">
                  {% with kind=site.kind|capfirst %}
                    {% trans kind %}
                  {% endwith %}
                </a>
              {% endfor %}
              {% for site in representative.chamber_websites %}
                <a class="label label-primary" href="{{ site.url }}" target="_blank">
                  {% bootstrap_icon "user" %}
                  {% trans "Parliament page" %}
                </a>
              {% endfor %}
              {% for site in representative.other_websites %}
                <a class="label label-primary" href="{{ site.url }}" target="_blank">
                  {% bootstrap_icon "link" %}
                  {% trans "Website" %}
                </a>
              {% endfor %}

              {% for email in representative.email_set.all %}
                <a class="label label-primary" href="mailto:{{ email.email }}">
                  <b>@</b>
                  {% trans "E-mail" %}
                </a>
              {% endfor %}
            </dd>
          {% endif %}

          {% if representative.address_set.all|length or representative.phone_set.all|length %}
            <dt>{% trans "Contact" %}</dt>
            <dd>
              {% trans "Other address" as default_label %}

              {% for address in representative.address_set.all %}
                <span class="label label-primary" data-toggle="tooltip" data-placement="bottom" title="{% if address.floor and address.office_number %}Floor {{ address.floor }} &ndash; office {{ address.office_number }} &ndash; {% endif %}{{ address.number }} {{ address.street }} &ndash; {{ address.city }} {{ address.postcode }}, {{ address.country.name }}">
                  {% bootstrap_icon "envelope" %}
                  {{ address.name|default:default_label }}
                </span>

                {% for phone in address.phones.all %}
                  <span class="label label-primary" data-toggle="tooltip" data-placement="bottom" title="{{ phone.number }}">
                    {% bootstrap_icon "earphone" %}
                    {{ address.name }}
                  </span>

                {% endfor %}
              {% endfor %}

              {% for phone in representative.phone_set.all %}
                <span class="label label-primary">
                  {% bootstrap_icon "earphone" %}
                  {{ phone.number }}
                </span>

              {% endfor %}
            </dd>
          {% endif %}

          {# <dt>More infos</dt><dd><a><span class="label label-primary"><span class="glyphicon glyphicon-grain"></span> Facebook</span></a> <a><span class="label label-primary"><span class="glyphicon glyphicon-plane"></span> Twitter</span></a> <a><span class="label label-primary"><span class="glyphicon glyphicon-tree-conifer"></span> Parliement</span></a></dd> #}
        </dl>
      </div>
    </div>
  </div>

  <div class="row">
    <div class="col-xs-12">
      <ul class="nav nav-tabs nav-justified" role="tablist">
        <li role="presentation" {% if tab == 'votes' %}class="active"{% endif %}>
          <a href="{% url 'representative-votes' slug=representative.slug %}" role="tab">
            <h3>{% trans "Votes" %}</h3>
          </a>
        </li>
        <li role="presentation" {% if tab == 'mandates' %}class="active"{% endif %}>
          <a href="{% url 'representative-mandates' slug=representative.slug %}" role="tab">
            <h3>{% trans "Mandates" %}</h3>
          </a>
        </li>
        <li role="presentation" {% if tab == 'positions' %}class="active"{% endif %}>
          <a href="{% url 'representative-positions' slug=representative.slug %}" role="tab">
            <h3>{% trans "Public positions" %}</h3>
          </a>
        </li>
      </ul>

      <div class="tab-content">
        {% block representative_content %}{% endblock %}
      </div>
    </div>
  </div>
  {% endblock %}

{% endwith %}
