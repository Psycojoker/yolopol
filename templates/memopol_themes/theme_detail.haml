- extends "base.html"

- load i18n
- load memopol_tags

- block content

  %h1 {{ theme.name }}

  %h2
    - trans "Description"

  %p.description
    {{ theme.description }}

  %h2
    - trans "Links"

  %table.table

    - for link in theme.links.all
      %tr
        %td
          %a.external{'href': '{{ link.link }}', target:'_blank'}
              = link.title
        %td
          = link.datetime

  %h2
    - trans "Dossiers"

  %table.table
    %tr
      %th
        - trans "Chambers"
      %th
        - trans "Dossier"
      %th
        - trans "Reference"

    - for dossier in theme.dossiers.all
      %tr
        %td
          - for chamber in dossier.chambers
            = chamber | chamber_small_icon
        %td
          %a{'href': "{% url 'dossier-detail' dossier.pk %}"}
            {{ dossier.title }}

        %td= dossier.reference

  %h2
    - trans "Proposals"

  %table.table
    %tr
      %th
        - trans "Chambers"
      %th
        - trans "Dossier"
      %th
        - trans "Reference"
      %th
        - trans "Proposal"
      %th
        - trans "Title"
      %th
        - trans "Recommendation"
      %th
        - trans "Status"
      %th= "for" | position_icon
      %th= "against" | position_icon
      %th= "abstain" | position_icon

    - for proposal in theme.proposals.all

      %tr
        %td
          - for chamber in proposal.dossier.chambers
            = chamber | chamber_small_icon
        %td
          %a{'href': "{% url 'dossier-detail' proposal.dossier.pk %}"}
            {{ proposal.dossier.title }}

        %td= proposal.dossier.reference

        %td
          = proposal.title
          %br
          %small
            {{ proposal.reference }}

        - if proposal.recommendation

          %td= proposal.recommendation.title
          %td= proposal.recommendation.recommendation | position_icon

        - else
          %td.no-recommendation{colspan:2}= "No recommendation"

        %td= proposal.status
        %td= proposal.total_for
        %td= proposal.total_against
        %td= proposal.total_abstain


  %h2
    - trans "Positions"

  %table.table
    %tr
      %th
        - trans "Representative"
      %th
        - trans "Date"
      %th
        - trans "Position"
      %th
        - trans "Link"

      - for position in theme.positions.all

        %tr.position
          %td
            = position.representative
          %td= position.datetime
          %td
            %a{:href => '{{ position.get_absolute_url }}'}
              =position.text|truncatewords:8
          %td
            %a{:href => '{{ position.link }}'}
              = position.link
